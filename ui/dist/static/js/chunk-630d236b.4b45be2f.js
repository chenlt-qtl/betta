(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-630d236b"],{"00b5":function(e,t,n){},"10d4":function(e,t,n){"use strict";n("d2f8")},"1b9b":function(e,t,n){"use strict";n("9093")},"1d6a":function(e,t,n){"use strict";n("00b5")},"1e31":function(e,t,n){},"25df":function(e,t,n){"use strict";n("4265")},2934:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a}));var o=n("b775");function i(e){return Object(o["a"])({url:"/common/uploadImg/note",method:"post",data:{file:e}})}function a(e,t){return Object(o["a"])({url:"/common/upload/url/"+t,method:"post",params:{url:e}})}},4024:function(e,t,n){"use strict";n.r(t);var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"app-container"},[n("el-row",{staticClass:"note-info",attrs:{gutter:20}},[n("el-col",{attrs:{span:8,xs:24}},[n("NoteMenu")],1),n("el-col",{attrs:{span:16,xs:24}},[n("NoteContent")],1)],1)],1)},i=[],a=(n("ac1f"),n("841c"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-row",{staticClass:"note-info",attrs:{gutter:20}},[n("el-col",{attrs:{span:12,xs:24}},[n("NoteTree")],1),n("el-col",{attrs:{span:12,xs:24}},[n("NoteList")],1)],1)}),s=[],r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"note-tree"},[n("div",{staticClass:"head-container"},[n("el-input",{attrs:{placeholder:"请输入笔记名称",clearable:"",size:"small","prefix-icon":"el-icon-search"},model:{value:e.noteName,callback:function(t){e.noteName=t},expression:"noteName"}}),n("NoteAddBtn")],1),n("div",{staticClass:"tree-container"},[n("el-tree",{ref:"tree",attrs:{data:e.treeData,"node-key":"id",props:e.defaultProps,"filter-node-method":e.filterNode,"highlight-current":""},on:{"node-click":e.handleNodeClick},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.node;return n("span",{staticClass:"custom-tree-node"},[n("span",{staticClass:"label",attrs:{title:o.label}},[e._v(e._s(o.label))]),o.data.id?n("span",{staticClass:"dropdown"},[n("NoteTreeDropdown",{attrs:{note:o.data}})],1):e._e()])}}])})],1)])},l=[],c=n("5530"),d=(n("4de4"),n("14d9"),n("d3b7"),function(){var e=this,t=this,n=t.$createElement,o=t._self._c||n;return o("div",[o("el-dropdown",{attrs:{trigger:"click"},on:{command:t.handleCommand}},[o("span",{staticClass:"el-dropdown-link"},[o("svg-icon",{attrs:{"icon-class":"ellipsis-v"}})],1),o("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[o("el-dropdown-item",{attrs:{command:"rename"}},[t._v("重命名")]),o("el-dropdown-item",{attrs:{command:"move"}},[t._v("移动")]),o("el-dropdown-item",{attrs:{divided:"",command:"del"}},[t._v("删除")])],1)],1),o("el-dialog",{attrs:{title:"请输入文件夹名称",visible:t.openRename,width:"500px","append-to-body":""},on:{"update:visible":function(e){t.openRename=e}}},[o("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules}},[o("el-form-item",{attrs:{label:"",prop:"name"}},[o("el-input",{attrs:{placeholder:"请输入文件夹名称"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1)],1),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{type:"primary"},on:{click:t.rename}},[t._v("确 定")]),o("el-button",{on:{click:function(){return e.openRename=!1}}},[t._v("取 消")])],1)],1),o("NoteMoveDialogVue",{ref:"moveDialog"})],1)}),u=[],h=(n("b0c0"),n("c8aa")),p=function(){var e=this,t=this,n=t.$createElement,o=t._self._c||n;return o("el-dialog",{attrs:{title:"移动到",visible:t.open,width:"500px","append-to-body":""},on:{"update:visible":function(e){t.open=e}}},[o("div",{staticClass:"note-move"},[o("div",{staticClass:"head-container"},[o("el-input",{attrs:{placeholder:"请输入名称",clearable:"",size:"small","prefix-icon":"el-icon-search"},model:{value:t.noteName,callback:function(e){t.noteName=e},expression:"noteName"}})],1),o("div",{staticClass:"tree-container"},[o("el-tree",{ref:"tree",attrs:{data:t.treeData,"node-key":"id",props:t.defaultProps,"filter-node-method":t.filterNode,"highlight-current":""},on:{"node-click":t.handleNodeClick}})],1),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{type:"primary"},on:{click:t.submitForm}},[t._v("确 定")]),o("el-button",{on:{click:function(){return e.open=!1}}},[t._v("取 消")])],1)])])},f=[],m={data:function(){return{noteName:"",form:{},open:!1,loading:!0,newTreeId:null,defaultProps:{children:"children",label:"label",id:"id"}}},computed:{treeData:function(){return this.$store.state.note.treeData}},watch:{noteName:function(e){this.$refs.tree.filter(e)}},methods:{filterNode:function(e,t){return!e||-1!==t.label.indexOf(e)},handleNodeClick:function(e){this.newTreeId=e.id},openDialog:function(e){this.form=e,this.open=!0;var t=this.form.parentId;void 0!=t&&this.$nextTick((function(){var e=this.$refs.tree.getNode(t);function n(e){e.expand(),e.parent&&n(e.parent)}e&&!e.expanded&&n(e),e&&this.$refs.tree.setCurrentKey(t)}))},submitForm:function(){var e=this;this.form.parentId==this.newTreeId?this.$modal.msgError("新旧位置不能相同"):Object(h["h"])(this.form.ids,this.newTreeId).then((function(){e.$modal.msgSuccess("操作成功"),e.open=!1,e.$store.dispatch("note/getTreeData")}))}}},v=m,b=(n("c067"),n("2877")),g=Object(b["a"])(v,p,f,!1,null,"754a1e57",null),y=g.exports,w={name:"NoteTreeDropdown",components:{NoteMoveDialogVue:y},props:["note"],data:function(){return{openRename:!1,form:{},rules:{name:[{required:!0,message:"名称不能为空",trigger:"change"}]}}},computed:{selectedNoteId:function(){return this.$store.state.note.selectedNoteId}},methods:{handleCommand:function(e){if(this.note.id){var t=this.note,n=t.id,o=t.label,i=t.parentId;switch(e){case"del":this.delNote();break;case"rename":this.form={id:n,name:o,parentId:i},this.openRename=!0;break;case"move":this.$refs.moveDialog.openDialog({ids:n,parentId:i});break;default:break}}},rename:function(){var e=this,t={id:this.selectedNoteId,name:this.form.name};Object(h["g"])(t).then((function(){e.$modal.msgSuccess("修改成功"),e.openRename=!1,e.$store.dispatch("note/getTreeData")}))},delNote:function(){var e=this;this.$confirm("删除文件夹 [ "+this.note.label+" ] , 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.$store.dispatch("note/delNotes",[e.note.id]).then((function(){e.$message({type:"success",message:"删除成功!"})}))}))}}},N=w,$=Object(b["a"])(N,d,u,!1,null,null,null),k=$.exports,x=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"note-add-btn"},[n("el-dropdown",{on:{command:e.handleCommand}},[n("span",{staticClass:"el-dropdown-link"},[e._v(" 增加"),n("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[n("el-dropdown-item",{attrs:{command:"file"}},[n("i",{staticClass:"el-icon-document"}),e._v("笔记")]),n("el-dropdown-item",{attrs:{command:"dir"}},[n("i",{staticClass:"el-icon-folder"}),e._v("文件夹")])],1)],1),n("el-dialog",{attrs:{title:"请输入"+(this.isLeaf?"笔记":"文件夹")+"名称",visible:e.open,width:"500px","append-to-body":""},on:{"update:visible":function(t){e.open=t}}},[n("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules},nativeOn:{submit:function(e){e.preventDefault()}}},[n("el-form-item",{attrs:{label:"",prop:"name"}},[n("el-input",{attrs:{placeholder:"请输入标题"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submitForm(t)}},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1)],1),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("确 定")]),n("el-button",{on:{click:e.cancel}},[e._v("取 消")])],1)],1)],1)},_=[],C={data:function(){return{open:!1,form:{},isLeaf:!1,rules:{name:[{required:!0,message:"名称不能为空",trigger:"change"}]}}},computed:{selectedNoteId:function(){return this.$store.state.note.selectedNoteId}},methods:{submitForm:function(){var e=this;this.$refs["form"].validate((function(t){if(t){var n={name:e.form.name,parentId:e.selectedNoteId,isLeaf:e.isLeaf};Object(h["a"])(n).then((function(t){e.$modal.msgSuccess("保存成功"),e.open=!1,e.$store.dispatch("note/getListData"),e.isLeaf?e.$router.push({path:"/n/note",query:Object(c["a"])(Object(c["a"])({},e.$route.query),{},{id:t.data})}):e.$store.dispatch("note/getTreeData")}))}}))},cancel:function(){this.open=!1},handleCommand:function(e){if(void 0==this.selectedNoteId)this.$modal.msgError("请选择要增加的文件夹");else switch(this.form={},this.open=!0,e){case"file":this.isLeaf=!0;break;case"dir":this.isLeaf=!1;break}}}},O=C,S=(n("25df"),Object(b["a"])(O,x,_,!1,null,"b60228b2",null)),I=S.exports,j={name:"NoteTree",components:{NoteTreeDropdown:k,NoteAddBtn:I},data:function(){return{noteName:"",loading:!0,defaultProps:{children:"children",label:"label",id:"id"}}},computed:{treeData:function(){return this.$store.state.note.treeData},openedNote:function(){return this.$store.state.note.openedNote},selectedNoteId:function(){return this.$store.state.note.selectedNoteId}},watch:{noteName:function(e){this.$refs.tree.filter(e)},openedNote:function(){this.selectNode(this.openedNote.parentId)},selectedNoteId:function(){this.selectNode(this.selectedNoteId)},treeData:function(){var e=this;this.$nextTick((function(){e.selectNode(e.openedNote.parentId)}))}},methods:{filterNode:function(e,t){return!e||-1!==t.label.indexOf(e)},handleNodeClick:function(e){this.$store.dispatch("note/setSelectedNoteId",e.id),this.$store.dispatch("note/setSelectedNoteName",e.label);var t=Object(c["a"])({},this.$route.query);delete t.type,this.$router.push({path:"/n/note",query:t})},selectNode:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=this.$refs.tree.getNode(e);function n(e){e.expand(),e.parent&&n(e.parent)}t&&n(t),t&&(this.$refs.tree.setCurrentKey(e),this.$store.dispatch("note/setSelectedNoteName",t.label))}}},T=j,q=(n("d2f4"),Object(b["a"])(T,r,l,!1,null,null,null)),L=q.exports,D=function(){var e=this,t=this,n=t.$createElement,o=t._self._c||n;return o("div",{staticClass:"note-list"},[t.type?t._e():o("el-row",{staticClass:"mb8",attrs:{gutter:10}},[o("el-col",{attrs:{span:24}},[o("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入内容"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onSearch(e)}},model:{value:t.searchStr,callback:function(e){t.searchStr=e},expression:"searchStr"}},[o("el-button",{attrs:{slot:"append",icon:"el-icon-search",size:"mini"},on:{click:t.onSearch},slot:"append"})],1)],1)],1),o("div",{staticClass:"toolbar"},[o("span",{staticClass:"label"},[t._v(" "+t._s(t.label)+" ")]),o("span",[t.isCheck?t._e():o("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["note:noteInfo:remove"],expression:"['note:noteInfo:remove']"}],attrs:{type:"text",size:"mini",disabled:t.listNote.length<=0||null!=t.type},on:{click:t.handleCheck}},[t.isCheck?t._e():o("svg-icon",{attrs:{"icon-class":"checkbox"}})],1),t.isCheck?o("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["note:noteInfo:edit"],expression:"['note:noteInfo:edit']"}],attrs:{type:"text",icon:"el-icon-truck",size:"mini",disabled:t.multiple},on:{click:t.handleMove}}):t._e(),t.isCheck?o("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["note:noteInfo:remove"],expression:"['note:noteInfo:remove']"}],attrs:{type:"text",icon:"el-icon-delete",size:"mini",disabled:t.multiple},on:{click:t.handleDelete}},[t._v("删除")]):t._e(),t.isCheck?o("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(){return e.isCheck=!1}}},[t._v("取消")]):t._e()],1)]),o("div",{staticClass:"table"},[o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"table",attrs:{"highlight-current-row":"",data:t.listNote,size:"mini","show-header":!1},on:{"row-click":t.handleRowClick,"selection-change":t.handleSelectionChange}},[t.isCheck?o("el-table-column",{attrs:{type:"selection",width:"28"}}):t._e(),t.showSelect?o("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}):t._e(),o("el-table-column",{attrs:{label:t.label,"show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[o("i",{class:e.row.isLeaf?"el-icon-document":"el-icon-folder"}),o("span",{staticStyle:{"margin-left":"10px"}},[t._v(t._s(e.row.name))])]}}])})],1)],1),o("noteMoveDialog",{ref:"moveDialog"})],1)},E=[],P=(n("7db0"),n("caad"),n("d81d"),n("2532"),{name:"NoteList",components:{noteMoveDialog:y},data:function(){return{searchStr:this.search,isCheck:!1,loading:!1,ids:[],showSelect:!1,single:!0,multiple:!0,label:""}},created:function(){this.setLabel()},computed:{listNote:function(){return this.$store.state.note.listNote},openedNote:function(){return this.$store.state.note.openedNote},type:function(){return this.$route.query&&this.$route.query.type},selectedNoteName:function(){return this.$store.state.note.selectedNoteName},selectedNoteId:function(){return this.$store.state.note.selectedNoteId},search:function(){return this.$route.query&&this.$route.query.search}},watch:{openedNote:function(){this.selectOpenRow()},listNote:function(){this.selectOpenRow()},type:function(){this.setLabel()},selectedNoteName:function(){this.setLabel()},search:function(e){this.searchStr=e}},methods:{setLabel:function(){switch(this.type){case"fav":this.label="收藏夹";break;case"last":this.label="最近文档";break;default:this.$store.state.note.search?this.label="搜索结果":this.label=this.selectedNoteName}},selectOpenRow:function(){var e=this;if(this.openedNote.id){var t=this.listNote.find((function(t){return t.id==e.openedNote.id}));t&&this.$refs.table.setCurrentRow(t)}},handleRowClick:function(e){this.$router.push({path:"/n/note",query:Object(c["a"])(Object(c["a"])({},this.$route.query),{},{id:e.id})})},onSearch:function(){this.$store.dispatch("note/setSelectedNoteId",0),this.$router.push({path:"/n/note",query:Object(c["a"])(Object(c["a"])({},this.$route.query),{},{search:this.searchStr})})},handleCheck:function(){this.isCheck=!0},handleDelete:function(e){var t=this,n=e.id?[e.id]:this.ids;this.$modal.confirm('是否确认删除文件夹编号为"'+n+'"的数据项？').then((function(){t.$store.dispatch("note/delNotes",n)})).then((function(e){if(e&&200==e.code&&(t.$modal.msgSuccess("删除成功"),n.includes(t.openedNote.id))){var o=Object(c["a"])({},t.$route.query);delete o["id"],t.$router.push({path:"/n/note",query:o})}})).catch((function(){}))},handleSelectionChange:function(e){this.ids=e.map((function(e){return e.id})),this.single=1!=e.length,this.multiple=!e.length},handleMove:function(){this.$refs.moveDialog.openDialog({ids:this.ids,parentId:this.selectedNoteId})}}}),F=P,V=(n("10d4"),Object(b["a"])(F,D,E,!1,null,null,null)),z=V.exports,R={name:"NoteMenu",components:{NoteTree:L,NoteList:z},data:function(){return{}}},M=R,B=Object(b["a"])(M,a,s,!1,null,null,null),H=B.exports,A=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"note-content"},[n("OpenedTab"),e.openedNote.id?n("div",[n("div",{staticClass:"toolbar"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.title,expression:"title"}],ref:"title",attrs:{maxLength:"100"},domProps:{value:e.title},on:{input:[function(t){t.target.composing||(e.title=t.target.value)},e.onChange],blur:e.updateTitle}}),n("NoteHistoryListBtn"),n("NoteHistorySaveBtn",{attrs:{text:e.content.text}}),e.isFav?e._e():n("i",{staticClass:"el-icon-star-off orange",on:{click:function(){return e.updateFav(!0)}}}),e.isFav?n("i",{staticClass:"el-icon-star-on orange",on:{click:function(){return e.updateFav(!1)}}}):e._e(),e.isSaved?n("i",{staticClass:"el-icon-circle-check icon",staticStyle:{color:"#78e08f"}}):e._e(),e.isSaved?e._e():n("i",{staticClass:"el-icon-warning-outline orange icon"}),e.isViewer?e._e():n("el-button",{attrs:{icon:"el-icon-view",type:"text"},on:{click:function(){return e.isViewer=!0}}}),e.isViewer?n("el-button",{attrs:{icon:"el-icon-edit",type:"text"},on:{click:function(){return e.isViewer=!1}}}):e._e()],1),null==e.content.id?n("div",{staticClass:"blank"},[n("i",{staticClass:"el-icon-monitor",staticStyle:{color:"gray","font-size":"80px"}})]):e._e(),n("div",{style:{display:null==e.content.id?"none":"block"}},[n("MdEditor",{attrs:{isViewer:e.isViewer,value:e.content.text},on:{blur:e.updateText,change:e.onChange}})],1)]):e._e(),e.openedNote.id?e._e():n("el-empty",{attrs:{description:""}})],1)},U=[],Q=n("2909"),J=(n("99af"),n("a15b"),n("4d63"),n("c607"),n("2c3e"),n("25f0"),n("5319"),n("5b81"),n("159b"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("editor",{ref:"editor",style:{display:e.isViewer?"none":"block"},attrs:{options:e.editorOptions,height:"500px",previewStyle:"vertical"},on:{blur:e.onEditorBlur,keyup:e.onInput}}),n("div",{staticClass:"viewer-container",style:{display:e.isViewer?"flex":"none"}},[n("div",{staticClass:"toc-wrapper"},[n("toc",{attrs:{headings:e.headings}})],1),n("viewer",{ref:"viewRef",staticClass:"viewer",attrs:{height:"500px"}})],1)],1)}),K=[],G=n("c7eb"),W=n("1da1"),X=(n("fb6a"),n("e459")),Y=(n("f513"),n("fe5f"),n("a7be"),n("2934")),Z=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"toc-container"},e._l(e.headings,(function(t){return n("div",{key:t.id,class:["toc-item","toc-level-"+t.level]},[n("a",{on:{click:function(n){return e.scrollTo(t.id)}}},[e._v(e._s(t.text))])])})),0)},ee=[],te={props:{headings:{type:Array,required:!0}},methods:{scrollTo:function(e){var t=document.querySelector(".toastui-editor-contents"),n=t.querySelector("#".concat(e));n&&n.scrollIntoView({behavior:"smooth",block:"start"})}}},ne=te,oe=(n("4e00"),Object(b["a"])(ne,Z,ee,!1,null,null,null)),ie=oe.exports,ae={props:["value","isViewer"],components:{editor:X["a"],viewer:X["b"],toc:ie},watch:{value:function(){var e=this;this.$refs.viewRef&&this.$refs.viewRef.invoke("setMarkdown",this.value||"",!1),this.$refs.editor&&this.$refs.editor.invoke("setMarkdown",this.value||"",!1),this.$nextTick((function(){e.parseHeadings()}))}},data:function(){return{editorOptions:{hooks:{addImageBlobHook:this.uploadImg}},updateEditor:!1,headings:[]}},methods:{onEditorBlur:function(){var e=this;setTimeout((function(){e.$emit("blur",e.$refs.editor.invoke("getMarkdown"))}),0)},onInput:function(){this.$emit("change")},uploadImg:function(e,t){var n=this;if(this.handleBeforeUpload(e)){var o=new FileReader;o.onload=Object(W["a"])(Object(G["a"])().mark((function e(){return Object(G["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:Object(Y["b"])(o.result).then((function(e){e.data&&(n.$emit("change"),t("/file"+e.data))}));case 1:case"end":return e.stop()}}),e)}))),o.readAsDataURL(e)}},handleBeforeUpload:function(e){var t=["image/jpeg","image/jpg","image/png","image/svg"],n=t.includes(e.type);if(!n)return this.$message.error("图片格式错误!"),!1;if(this.fileSize){var o=e.size/1024/1024<this.fileSize;if(!o)return this.$message.error("上传文件大小不能超过 ".concat(this.fileSize," MB!")),!1}return!0},parseHeadings:function(){var e=this,t=this.$refs.editor.invoke("getHTML"),n=new DOMParser,o=n.parseFromString(t,"text/html"),i=[],a=0;o.querySelectorAll("h1, h2, h3, h4, h5, h6").forEach((function(t){var n=parseInt(t.tagName.slice(1),10),o=t.textContent,s=e.slugify(o,a++);t.id=s,i.push({level:n,text:o,id:s})})),this.$refs.viewRef.invoke("setHTML",o.body.innerHTML),this.headings=i},slugify:function(e,t){var n=e.toLowerCase().replace(/[^a-z0-9\u4e00-\u9fa5\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-");return"".concat(n,"-").concat(t)}}},se=ae,re=(n("93c9"),Object(b["a"])(se,J,K,!1,null,null,null)),le=re.exports,ce=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"open-tab"},[n("el-tabs",{attrs:{value:""+e.openedNoteId,closable:""},on:{edit:e.handleTabsEdit,"tab-click":e.handleClick}},e._l(e.tabData,(function(t){return n("el-tab-pane",{key:t.id,attrs:{name:""+t.id}},[n("span",{staticClass:"tab-item",attrs:{slot:"label"},slot:"label"},[e._v(e._s(t.name))])])})),1)],1)},de=[],ue={data:function(){return{editableTabsValue:"2",tabData:[]}},computed:{openedNotes:function(){return this.$store.state.note.openedNotes},openedNoteId:function(){return this.$store.state.note.openedNote.id}},watch:{openedNotes:function(){this.tabData=this.$store.state.note.openedNotes}},methods:{handleClick:function(e){this.$router.push({path:"/n/note",query:{id:e.name}})},handleTabsEdit:function(e,t){var n=this.$store.state.note.openedNote.id;if("remove"===t&&(this.tabData=this.tabData.filter((function(t){return t.id!=e})),this.$store.dispatch("note/setOpenedNotes",this.tabData),n==e)){var o=Object(c["a"])({},this.$route.query);delete o.id,this.$router.push({path:"/n/note",query:o})}}}},he=ue,pe=(n("1d6a"),Object(b["a"])(he,ce,de,!1,null,"726c5b11",null)),fe=pe.exports,me=n("b775");function ve(e){return Object(me["a"])({url:"/note/content/"+e,method:"get"})}function be(e){return Object(me["a"])({url:"/note/content",method:"put",data:e})}var ge=n("a84a"),ye=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"note-history-save"},[n("el-button",{attrs:{icon:"el-icon-download",type:"text"},on:{click:function(){return e.open=!0}}}),n("el-dialog",{attrs:{title:"请输入标题",visible:e.open,width:"500px","append-to-body":""},on:{"update:visible":function(t){e.open=t}}},[n("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules}},[n("el-form-item",{attrs:{label:"",prop:"title"}},[n("el-input",{attrs:{placeholder:"请输入标题"},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1)],1),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("确 定")]),n("el-button",{on:{click:e.cancel}},[e._v("取 消")])],1)],1)],1)},we=[];function Ne(e,t){return Object(me["a"])({url:"/note/history/list/"+t,method:"get",params:e})}function $e(e){return Object(me["a"])({url:"/note/history/"+e,method:"get"})}function ke(e){return Object(me["a"])({url:"/note/history",method:"post",data:e})}function xe(e){return Object(me["a"])({url:"/note/history",method:"put",data:e})}function _e(e){return Object(me["a"])({url:"/note/history/"+e,method:"delete"})}var Ce={props:["text"],data:function(){return{open:!1,form:{},rules:{title:[{required:!0,message:"标题不能为空",trigger:"change"}]}}},computed:{openedNote:function(){return this.$store.state.note.openedNote}},methods:{submitForm:function(){var e=this;this.$refs["form"].validate((function(t){if(t){var n={title:e.form.title,noteId:e.openedNote.id,text:e.text};ke(n).then((function(){e.$modal.msgSuccess("保存成功"),e.open=!1}))}}))},cancel:function(){this.open=!1}}},Oe=Ce,Se=(n("8cb9"),Object(b["a"])(Oe,ye,we,!1,null,"40829ab4",null)),Ie=Se.exports,je=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-button",{attrs:{icon:"el-icon-time",type:"text"},on:{click:e.onOpenList}}),n("el-dialog",{attrs:{title:e.title,visible:e.openList,width:"800px","append-to-body":"","custom-class":"note-history-list"},on:{"update:visible":function(t){e.openList=t}}},[n("el-form",{directives:[{name:"show",rawName:"v-show",value:e.showSearch,expression:"showSearch"}],ref:"queryForm",attrs:{model:e.queryParams,size:"small",inline:!0,"label-width":"68px"}},[n("el-form-item",{attrs:{label:"标题",prop:"title"}},[n("el-input",{attrs:{placeholder:"请输入标题",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleQuery(t)}},model:{value:e.queryParams.title,callback:function(t){e.$set(e.queryParams,"title",t)},expression:"queryParams.title"}})],1),n("el-form-item",[n("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"mini"},on:{click:e.handleQuery}},[e._v("搜索")]),n("el-button",{attrs:{icon:"el-icon-refresh",size:"mini"},on:{click:e.resetQuery}},[e._v("重置")])],1)],1),n("el-row",{staticClass:"mb8 toolbar",attrs:{gutter:10}},[n("el-col",{attrs:{span:1.5}},[n("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["note:history:remove"],expression:"['note:history:remove']"}],attrs:{type:"danger",plain:"",icon:"el-icon-delete",size:"mini",disabled:e.multiple},on:{click:e.handleDelete}},[e._v("删除")])],1),n("el-col",{staticStyle:{flex:"1"},attrs:{span:3.5}},[n("el-radio",{attrs:{label:"name"},model:{value:e.dataType,callback:function(t){e.dataType=t},expression:"dataType"}},[e._v("自定义")]),n("el-radio",{attrs:{label:"auto"},model:{value:e.dataType,callback:function(t){e.dataType=t},expression:"dataType"}},[e._v("自动")])],1),n("right-toolbar",{attrs:{showSearch:e.showSearch},on:{"update:showSearch":function(t){e.showSearch=t},"update:show-search":function(t){e.showSearch=t},queryTable:e.getList}})],1),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.historyList},on:{"selection-change":e.handleSelectionChange}},[n("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),"name"==e.dataType?n("el-table-column",{attrs:{label:"标题",align:"center",prop:"title"}}):e._e(),n("el-table-column",{attrs:{label:"日期",align:"center",prop:"createTime"}}),n("el-table-column",{attrs:{label:"操作",align:"center","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["note:history:query"],expression:"['note:history:query']"}],attrs:{size:"mini",type:"text",icon:"el-icon-search"},on:{click:function(n){return e.handleView(t.row)}}},[e._v("查看")]),"name"==e.dataType?n("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["note:history:edit"],expression:"['note:history:edit']"}],attrs:{size:"mini",type:"text",icon:"el-icon-edit"},on:{click:function(n){return e.handleUpdate(t.row)}}},[e._v("修改")]):e._e(),n("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["note:history:remove"],expression:"['note:history:remove']"}],attrs:{size:"mini",type:"text",icon:"el-icon-delete"},on:{click:function(n){return e.handleDelete(t.row)}}},[e._v("删除")])]}}])})],1),n("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total > 0"}],attrs:{total:e.total,page:e.queryParams.pageNum,limit:e.queryParams.pageSize},on:{"update:page":function(t){return e.$set(e.queryParams,"pageNum",t)},"update:limit":function(t){return e.$set(e.queryParams,"pageSize",t)},pagination:e.getList}}),n("el-dialog",{attrs:{title:e.title,visible:e.openEdit,width:"500px","append-to-body":""},on:{"update:visible":function(t){e.openEdit=t}}},[n("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"80px"}},[n("el-form-item",{attrs:{label:"标题",prop:"title"}},[n("el-input",{attrs:{placeholder:"请输入标题"},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1)],1),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("确 定")]),n("el-button",{on:{click:e.cancel}},[e._v("取 消")])],1)],1),n("el-dialog",{attrs:{title:e.title,visible:e.openView,width:"500px","append-to-body":""},on:{"update:visible":function(t){e.openView=t}}},[n("el-input",{attrs:{type:"textarea",rows:20,placeholder:"请输入内容",value:e.form.text}}),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"},on:{click:e.copy}},[e._v("复 制")]),n("el-button",{on:{click:e.cancelView}},[e._v("取 消")])],1)],1)],1)],1)},Te=[],qe={name:"History",data:function(){return{loading:!0,dataType:"name",ids:[],single:!0,multiple:!0,showSearch:!0,total:0,historyList:[],title:"",openList:!1,openEdit:!1,openView:!1,queryParams:{pageNum:1,pageSize:5,noteId:"",title:""},form:{},rules:{title:[{required:!0,message:"标题不能为空",trigger:"blur"}]}}},computed:{openedNote:function(){return this.$store.state.note.openedNote}},watch:{dataType:function(){this.getList()}},methods:{onOpenList:function(){this.openList=!0,this.queryParams.noteId!=this.openedNote.id&&(this.queryParams=Object(c["a"])(Object(c["a"])({},this.queryParams),{},{noteId:this.openedNote.id}),this.getList())},getList:function(){var e=this;this.loading=!0,Ne(this.queryParams,this.dataType).then((function(t){e.historyList=t.rows,e.total=t.total,e.loading=!1}))},cancel:function(){this.open=!1,this.reset()},cancelView:function(){this.openView=!1},reset:function(){this.form={id:null,noteId:null,title:null,text:null,createBy:null,createTime:null},this.resetForm("form")},handleQuery:function(){this.queryParams.pageNum=1,this.getList()},resetQuery:function(){this.resetForm("queryForm"),this.handleQuery()},handleSelectionChange:function(e){this.ids=e.map((function(e){return e.id})),this.single=1!==e.length,this.multiple=!e.length},handleAdd:function(){this.reset(),this.open=!0,this.title="添加历史"},handleUpdate:function(e){this.reset(),this.form=e,this.openEdit=!0,this.title="修改历史"},handleView:function(e){var t=this;this.openView=!0;var n=e.id||this.ids;$e(n).then((function(e){t.form=e.data,t.title="查看历史",t.openView=!0}))},submitForm:function(){var e=this;this.$refs["form"].validate((function(t){t&&(null!=e.form.id?xe(e.form).then((function(t){e.$modal.msgSuccess("修改成功"),e.openEdit=!1,e.getList()})):ke(e.form).then((function(t){e.$modal.msgSuccess("新增成功"),e.openEdit=!1,e.getList()})))}))},handleDelete:function(e){var t=this,n=e.id||this.ids;this.$modal.confirm('是否确认删除历史编号为"'+n+'"的数据项？').then((function(){return _e(n)})).then((function(){t.getList(),t.$modal.msgSuccess("删除成功")})).catch((function(){}))},copy:function(){var e=this;navigator.clipboard.writeText(this.form.text).then((function(){e.$modal.msgSuccess("Text copied to clipboard")})).catch((function(t){e.$modal.msgError("Failed to copy text: ",t)}))}}},Le=qe,De=(n("1b9b"),Object(b["a"])(Le,je,Te,!1,null,"b88b68da",null)),Ee=De.exports,Pe={components:{MdEditor:le,OpenedTab:fe,NoteHistorySaveBtn:Ie,NoteHistoryListBtn:Ee},data:function(){return{title:"",loading:!0,content:{},fav:{},isFav:!1,isSaved:!0,isViewer:!0}},created:function(){this.getContent(),this.getFav()},computed:{openedNote:function(){return this.$store.state.note.openedNote}},watch:{openedNote:function(){this.openedNote.id&&(this.isSaved=!0,this.getContent())}},methods:{getContent:function(){var e=this;this.loading=!0;var t=this.openedNote,n=t.name,o=t.contentId;this.title=n,o?ve(o).then((function(t){e.content=t.data,e.content&&e.content.text&&(e.content.text=e.replaceUrl(e.content.text)),e.loading=!1,e.isViewer=!0})):this.content={}},replaceUrl:function(e){var t=new RegExp("(?<=\\]\\()(\\/profile)?(?=\\/note)","g");return e.replaceAll(t,"/file")},getFav:function(){var e=this;Object(ge["b"])().then((function(t){var n=t.data;n&&(e.fav=n,e.fav.favNoteIds=(n.noteIds||"").split(","),e.isFav=e.fav.favNoteIds.includes(String(e.openedNote.id)))}))},onChange:function(){this.isSaved=!1},updateTitle:function(){var e=this;if(this.title){var t=Object(c["a"])(Object(c["a"])({},this.openedNote),{},{name:this.title});Object(h["g"])(t).then((function(){e.$modal.msgSuccess("修改成功"),e.isSaved=!0;var n=t.id,o=t.name,i=e.$store.state.note.openedNotes;i.forEach((function(e){e.id!=n||(e.name=o)})),e.$store.dispatch("note/setOpenedNotes",i),e.$store.dispatch("note/getListData")}))}else this.$modal.msgError("标题不能为空")},updateText:function(e){var t=this;if(!this.isSaved){var n="";e&&(n=e.replaceAll(new RegExp("(?<=\\]\\()/file(?=\\/note)","g"),"")),be(Object(c["a"])(Object(c["a"])({},this.content),{},{text:n})).then((function(){t.content.text=t.replaceUrl(n),t.isSaved=!0,t.$modal.msgSuccess("修改成功")}))}},updateFav:function(e){var t=this,n=[],o=this.fav,i=o.favNoteIds,a=o.id;n=e?[].concat(Object(Q["a"])(i),[this.openedNote.id]):i.filter((function(e){return e!=t.openedNote.id}));var s={id:a,noteIds:n.join(",")};a?Object(ge["d"])(s).then((function(){t.getFav()})):Object(ge["a"])(s).then((function(){t.getFav()}))}}},Fe=Pe,Ve=(n("5938"),Object(b["a"])(Fe,A,U,!1,null,"659b72c2",null)),ze=Ve.exports,Re={name:"NoteInfo",components:{NoteMenu:H,NoteContent:ze},created:function(){this.initData()},computed:{noteId:function(){return this.$route.query&&this.$route.query.id},type:function(){return this.$route.query&&this.$route.query.type},search:function(){return this.$route.query&&this.$route.query.search}},watch:{noteId:function(){this.getNote()},type:function(){this.$store.dispatch("note/setListType",this.type)},search:function(){this.$store.dispatch("note/setSearch",this.search)}},methods:{getNote:function(){return this.$store.dispatch("note/openNote",this.noteId)},initData:function(){var e=this;this.$store.dispatch("note/setListType",this.type),this.$store.dispatch("note/setSearch",this.search),this.getNote().then((function(){e.$store.dispatch("note/getTreeData")}))}}},Me=Re,Be=Object(b["a"])(Me,o,i,!1,null,null,null);t["default"]=Be.exports},4265:function(e,t,n){},"4e00":function(e,t,n){"use strict";n("f90f")},"504b":function(e,t,n){},5938:function(e,t,n){"use strict";n("504b")},"63a9":function(e,t,n){},"8cb9":function(e,t,n){"use strict";n("c75b")},9093:function(e,t,n){},"93c9":function(e,t,n){"use strict";n("1e31")},c067:function(e,t,n){"use strict";n("e9d7")},c75b:function(e,t,n){},d2f4:function(e,t,n){"use strict";n("63a9")},d2f8:function(e,t,n){},e9d7:function(e,t,n){},f90f:function(e,t,n){}}]);
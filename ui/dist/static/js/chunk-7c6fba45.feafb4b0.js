(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7c6fba45"],{6308:function(t,e,n){"use strict";n.r(e);var i,a,r,s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"playlist"},[n("div",{staticClass:"phone"},[n("div",{staticClass:"inner"},[t._m(0),n("div",{staticClass:"cover"},[n("img",{attrs:{src:t.baseUrl+"/profile/sys/img/18159534045164927.jpg",alt:"Sober Up"}})]),n("div",{staticClass:"info"},[n("h3",{staticClass:"song"},[t._v(t._s(t.mp3Name))]),n("h4",{staticClass:"artist"},[t._v(t._s(t.displayStr))])]),n("div",{staticClass:"time"},[n("div",{staticClass:"bar",style:{width:t.barPercent+"%"}})]),n("div",{staticClass:"control"},[n("button",{staticClass:"controlButton",on:{click:function(){return t.step(-1)}}},[n("i",{staticClass:"fa fa-step-backward"})]),n("button",{staticClass:"playButton",on:{click:t.playList}},[n("div",[t.isPlaying?t._e():n("i",{staticClass:"fa fa-play"}),t.isPlaying?n("i",{staticClass:"fa fa-pause",staticStyle:{"font-size":"22px",left:"0"}}):t._e()])]),n("button",{staticClass:"controlButton",on:{click:function(){return t.step(1)}}},[n("i",{staticClass:"fa fa-step-forward"})])])])])])},c=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"header"},[n("button",{staticClass:"button back"},[n("i",{staticClass:"fa fa-arrow-left"})]),n("h2",{staticClass:"title"},[t._v("播放列表")]),n("button",{staticClass:"button more"},[n("i",{staticClass:"fa fa-ellipsis-h"})])])}],u=n("c7eb"),o=n("2909"),l=n("1da1"),d=n("5530"),f=(n("14d9"),n("b0c0"),n("d3b7"),n("159b"),n("c074")),p=n("2f62"),h=n("dcec"),m=n("ac3c"),g=n("baee"),b={data:function(){return{baseUrl:"/prod-api",playIndex:-1,isPlaying:!1,listData:[],restTime:5400,isTimed:!1}},computed:Object(d["a"])(Object(d["a"])({},Object(p["b"])(["name"])),{},{mp3Name:function(){return this.listData.length>0&&-1!=this.playIndex?this.listData[this.playIndex].title:"无标题"},displayStr:function(){var t="",e=Math.floor(this.restTime/60);t+=e<10?"0":"",t+=e;var n=this.restTime%60;return t+=n<10?" : 0":" : ",t+=n,t},barPercent:function(){return 0==this.listData.length||-1==this.playIndex?0:100*(this.playIndex+1)/this.listData.length}}),created:function(){var t=this,e=this.$route.query&&this.$route.query.article;if(e)this.getArticleDetail(e);else{var n=this.name;if(!n&&(n=this.$route.query&&this.$route.query.u,!n))return void this.$modal.msgError("请输入用户名或文章ID");Object(h["e"])({pageNum:1,pageSize:1e3,inPlayList:!0,username:n}).then((function(e){var n=e.rows;n.forEach((function(e){return t.getSentence(e)}))}))}},methods:{getSentence:function(t){var e=this;return Object(l["a"])(Object(u["a"])().mark((function n(){var i,a,r;return Object(u["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return i=Object(o["a"])(e.listData),n.next=3,Object(m["e"])({pageNum:1,pageSize:1e3,articleId:t.id});case 3:return a=n.sent,a.rows&&a.rows.length>0&&a.rows.forEach((function(e){return i.push({mp3:e.mp3Time?t.mp3:e.mp3,mp3Time:e.mp3Time,title:t.title})})),n.next=7,Object(g["h"])({pageNum:1,pageSize:1e3,articleId:t.id});case 7:r=n.sent,r.rows&&r.rows.length>0&&r.rows.forEach((function(e){return i.push({mp3:e.phAnMp3,articleName:t.title})})),e.listData=i;case 10:case"end":return n.stop()}}),n)})))()},getArticleDetail:function(t){var e=this;return Object(l["a"])(Object(u["a"])().mark((function n(){var i,a;return Object(u["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,Object(h["c"])(t);case 2:i=n.sent,a=i.data,e.getSentence(a);case 5:case"end":return n.stop()}}),n)})))()},playList:function(){this.listData.length<=0?this.$modal.msgError("播放列表为空"):(this.isPlaying=!this.isPlaying,this.isPlaying?i?i.play():(r=(new Date).getTime(),this.playIndex=0,i=this.playMp3(),i.addEventListener("pause",this.onEnded)):i.pause(),this.isPlaying&&this.isTimed&&this.timed())},onEnded:function(){var t=this;if(this.isPlaying){var e=(new Date).getTime();if(this.playIndex<this.listData.length-1)this.playIndex=this.playIndex+1;else if(this.isTimed)this.playIndex=0;else{if(!((e-r)/6e4<=90))return;this.playIndex=0}setTimeout((function(){return t.playMp3()}),1500)}},timed:function(){var t=this;this.restTime<=0?(clearInterval(a),a=null,i.pause()):this.isPlaying&&(this.restTime=this.restTime-1,a=setTimeout((function(){return t.timed()}),1e3))},playMp3:function(){var t=this,e=this.listData.length;if(e>0&&this.playIndex<e&&this.playIndex>=0){var n=this.listData[this.playIndex],a=n.mp3,r=n.mp3Time;return i=Object(f["a"])(a,r,1,(function(){return t.step(1)})),i}},step:function(t){if(i){var e=this.listData.length,n=this.playIndex+t;console.log("===================================="),console.log(n),console.log("===================================="),n<e&&n>=0&&(console.log("===================================="),console.log(22222),console.log("===================================="),this.playIndex=n,i.pause(),this.playMp3())}}}},y=b,v=(n("6e9c"),n("2877")),w=Object(v["a"])(y,s,c,!1,null,"58b575e2",null);e["default"]=w.exports},"6e9c":function(t,e,n){"use strict";n("cb72")},ac3c:function(t,e,n){"use strict";n.d(e,"e",(function(){return a})),n.d(e,"d",(function(){return r})),n.d(e,"c",(function(){return s})),n.d(e,"a",(function(){return c})),n.d(e,"f",(function(){return u})),n.d(e,"b",(function(){return o}));var i=n("b775");function a(t){return Object(i["a"])({url:"/eng/sentence/list",method:"get",params:t})}function r(t){return Object(i["a"])({url:"/eng/sentence/list/play",method:"get",params:t})}function s(t){return Object(i["a"])({url:"/eng/sentence/"+t,method:"get"})}function c(t){return Object(i["a"])({url:"/eng/sentence",method:"post",data:t})}function u(t){return Object(i["a"])({url:"/eng/sentence",method:"put",data:t})}function o(t){return Object(i["a"])({url:"/eng/sentence/"+t,method:"delete"})}},baee:function(t,e,n){"use strict";n.d(e,"g",(function(){return a})),n.d(e,"f",(function(){return r})),n.d(e,"h",(function(){return s})),n.d(e,"d",(function(){return c})),n.d(e,"e",(function(){return u})),n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return l})),n.d(e,"i",(function(){return d})),n.d(e,"c",(function(){return f}));var i=n("b775");function a(t){return Object(i["a"])({url:"/eng/word/list",method:"get",params:t})}function r(t){return Object(i["a"])({url:"/eng/word/new",method:"get",params:t})}function s(t){return Object(i["a"])({url:"/eng/word/list/"+t.articleId,method:"get",params:t})}function c(t){var e=t.wordName;return Object(i["a"])({url:"/eng/word?wordName="+e,method:"get"})}function u(t){return Object(i["a"])({url:"/eng/word/"+t,method:"get"})}function o(t){return Object(i["a"])({url:"/eng/word",method:"post",data:t})}function l(t,e){return Object(i["a"])({url:"/eng/word/"+t,method:"post",contentType:"application/x-www-form-urlencoded",data:{words:e}})}function d(t){return Object(i["a"])({url:"/eng/word",method:"put",data:t})}function f(t){return Object(i["a"])({url:"/eng/word/"+t,method:"delete"})}},c074:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));n("ac1f"),n("00b4");var i,a=new Audio,r=function(t,e){var n,r,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){};a.src="/prod-api"+t,a.load(),clearTimeout(i),a.pause();var u=(e||"").split(",");if(2==u.length){if(/^\d+$/.test(u[0]))r=parseInt(u[0]);else if(/^\d+:\d+$/.test(u[0])){var o=u[0].split(":");r=60*parseInt(o[0])+parseInt(o[1])}/^\d+(.\d+)*$/.test(u[1])&&(n=parseFloat(u[1]))}if(a.currentTime=0|r,a.playbackRate=s,a.play().catch((function(t){c&&c(t)})),n){var l=n/s;console.log("duration",l),i=setTimeout((function(){a.pause()}),1e3*l)}return a}},cb72:function(t,e,n){},dcec:function(t,e,n){"use strict";n.d(e,"d",(function(){return a})),n.d(e,"c",(function(){return r})),n.d(e,"a",(function(){return s})),n.d(e,"f",(function(){return c})),n.d(e,"b",(function(){return u})),n.d(e,"e",(function(){return o}));var i=n("b775");function a(t){return Object(i["a"])({url:"/eng/article/list",method:"get",params:t})}function r(t){return Object(i["a"])({url:"/eng/article/"+t,method:"get"})}function s(t){return Object(i["a"])({url:"/eng/article",method:"post",data:t})}function c(t){return Object(i["a"])({url:"/eng/article",method:"put",data:t})}function u(t){return Object(i["a"])({url:"/eng/article/"+t,method:"delete"})}function o(t){return Object(i["a"])({url:"/eng/article/list/play",method:"get",params:t})}}}]);